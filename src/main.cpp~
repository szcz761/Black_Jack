#include <fstream>
#include "Game.h"

using namespace std;

void deck_fill(string file_name, vector<string>& deck) 
{
  ifstream file(file_name,ios::in);
  if (file.is_open()) 
    {
      string cards="";
      getline(file, cards);
      string delimiter = ";";
      unsigned int position=0;
      while ((position = cards.find(delimiter)) != string::npos) 
	{
	  deck.push_back(cards.substr(0, cards.find(delimiter)));
	  cards.erase(0, cards.find(delimiter) + delimiter.length());
	}
    }
  else
    {
      string EX="Can't Open File!";
      throw EX;
    } 
}

bool fillDeck(std::string filePath, std::vector<std::string>& vec) {
		std::ifstream file(filePath, std::ios::in);
		if (file.is_open()) {
			std::string allCards = "";
			std::getline(file, allCards);
			std::string delimiter = ";";
			size_t pos = 0;
			while ((pos = allCards.find(delimiter)) != std::string::npos) {
				vec.push_back(allCards.substr(0, allCards.find(delimiter)));
				allCards.erase(0, allCards.find(delimiter) + delimiter.length());
			}
		}
		else
			throw -2;

	return true;
}

int main(int argc, char *argv[])
{
try
  {
    vector<string> deck;
    string file_name=(string)argv[1];
    //deck_fill(file_name,deck);
    fillDeck(argv[1],deck);
    Croupier_Player croupier(&deck);
    Carefull_Player carefull_player(&deck);
    My_Player my_player(&deck);
    
    Game game(deck, my_player, croupier);
    game.play_game();
    
  }
 catch(string EX)
   {
     cout<<EX<<endl;
   }
 return 0;
}
